# @foundcareers/redux-entity

[![build status](https://img.shields.io/npm/v/@foundcareers/redux-entity.svg)](https://www.npmjs.com/package/@foundcareers/redux-entity) [![build status](https://img.shields.io/travis/com/foundcareers/redux-entity.svg)](https://travis-ci.com/foundcareers/redux-entity) [![npm downloads](https://img.shields.io/npm/dt/@foundcareers/redux-entity.svg)](https://www.npmjs.com/package/@foundcareers/redux-entity) [![semantic-release](https://img.shields.io/badge/%20%20%F0%9F%93%A6%F0%9F%9A%80-semantic--release-e10079.svg)](https://github.com/semantic-release/semantic-release)

This library contains a bunch of helpers to manage entity collections in a redux store. 

## Installation

Install via npm: 
`npm i -s @foundcareers/redux-entity`

Install via yarn: 
`yarn add @foundcareers/redux-entity`

## Example Collection State

Here's an example store that works with `@foundcareers/redux-entity`.

```js
{
  todos: {
    entities: {
      'be9a-423mfas5345sd': {
        id: 'be9a-423mfas5345sd',
        value: 'Write todo'
      },
      'be9a-a245gf2033a20': {
        id: 'be9a-a245gf2033a20',
        value: 'Grill salmon'
      },      
    },
    meta: {
      currentPage: 2,
      nextPage: 3,
      prevPage: 1,
      totalPages: 4,
      totalCount: 12,
    },
    selectedEntityId: 'be9a-a245gf2033a20',
  },
  users: {
    entities: {
      'be9a-a245gf2033a21': {
        id: 'be9a-a245gf2033a21',
        name: 'Bob cutlass'
      },
      'ke9a-a245gf2033a22': {
        id: 'ke9a-a245gf2033a22',
        name: 'Peter Noopter'
      },
    },
    meta: {
      currentPage: 2,
      nextPage: 1,
      prevPage: 1,
      totalPages: 2,
      totalCount: 3,
    },
    selectedEntityId: 'ke9a-a245gf2033a22',
  },
}
```

# Documentation

<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

### Table of Contents

-   [Actions](#actions)
    -   [createActionsConfig](#createactionsconfig)
        -   [Parameters](#parameters)
        -   [Examples](#examples)
    -   [createActions](#createactions)
        -   [Parameters](#parameters-1)
        -   [Examples](#examples-1)
-   [Reducers](#reducers)
    -   [addEntity](#addentity)
        -   [Parameters](#parameters-2)
    -   [addEntities](#addentities)
        -   [Parameters](#parameters-3)
    -   [removeEntity](#removeentity)
        -   [Parameters](#parameters-4)
    -   [removeEntities](#removeentities)
        -   [Parameters](#parameters-5)
    -   [removeSelectedEntity](#removeselectedentity)
        -   [Parameters](#parameters-6)
    -   [addMeta](#addmeta)
        -   [Parameters](#parameters-7)
    -   [select](#select)
        -   [Parameters](#parameters-8)
    -   [reset](#reset)
        -   [Parameters](#parameters-9)
    -   [createReducer](#createreducer)
        -   [Parameters](#parameters-10)
        -   [Examples](#examples-2)
-   [Selectors](#selectors)
    -   [getEntities](#getentities)
        -   [Parameters](#parameters-11)
    -   [getEntitiesArray](#getentitiesarray)
        -   [Parameters](#parameters-12)
        -   [Examples](#examples-3)
    -   [getSelectedEntityId](#getselectedentityid)
        -   [Parameters](#parameters-13)
    -   [getMeta](#getmeta)
        -   [Parameters](#parameters-14)
    -   [getNextPage](#getnextpage)
        -   [Parameters](#parameters-15)
    -   [getPrevPage](#getprevpage)
        -   [Parameters](#parameters-16)
    -   [getStartCursor](#getstartcursor)
        -   [Parameters](#parameters-17)
    -   [getEndCursor](#getendcursor)
        -   [Parameters](#parameters-18)
-   [Factories](#factories)
    -   [createCollectionState](#createcollectionstate)
        -   [Parameters](#parameters-19)
        -   [Examples](#examples-4)

## Actions

### createActionsConfig

Helps create an actions config (used in Actions::createActions).

#### Parameters

-   `config` **[Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)>** Array of strings containing actions in camelCase. (optional, default `[]`)

#### Examples

```javascript
import { createActionsConfig } from '@foundcareers/redux-entity';

const config = createActionsConfig(['fetch', 'delete'])

// config
[
   'addEntity',
   'addEntities',
   'removeEntity',
   'removeEntities',
   'removeSelectedEntity',
   'addMeta',
   'select',
   'reset',
   // Custom config
   'fetch',
   'delete'
]
```

### createActions

Creates an object containing action types and creators.

#### Parameters

-   `namespace` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** Action types namespace in camelCase. (optional, default `'undefined'`)
-   `config` **[Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)>** Array of strings containing actions in camelCase. (optional, default `[]`)

#### Examples

```javascript
import { createActionsConfig } from '@foundcareers/redux-entity';

const { types, creators } = createActions('collection',
 ['addEntity', 'removeEntity']
);

// types
{
 REMOVE_ENTITY: '[Collection] Remove Entity',
 ADD_ENTITY: '[Collection] Add Entity'
}

// creators
{
 removeEntity: payload => ({ type: '[Collection] Remove Entity', payload }),
 addEntity: payload => ({ type: '[Collection] Add Entity', payload })
}
```

## Reducers

### addEntity

Add an entity to the collection state.

#### Parameters

-   `state` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** Collection state.
-   `payload` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** The entity object you'd like to add. Must contain an `id` attribute.

### addEntities

Adds entities to the collection state.

#### Parameters

-   `state` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** Collection state.
-   `payload` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** Object containing entities you'd like to add to the collection.

### removeEntity

Remove an entity from the collection state.

#### Parameters

-   `state` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** Collection state.
-   `id` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** Id of entity you'd like to remove from the collection state.

### removeEntities

Removes entities from the collection state.

#### Parameters

-   `state` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** Collection state.
-   `ids` **[Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)>** An array of entity ids.

### removeSelectedEntity

Remove the selected entity.

#### Parameters

-   `state` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** Collection state.

### addMeta

Add a meta object to the collection state.

#### Parameters

-   `state` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** Collection state.
-   `payload` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** The meta object.

### select

Select an entity in the collection state.

#### Parameters

-   `state` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** Collection state.
-   `selectedEntityId` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** Entity Id that's being selected.

### reset

Reset the collection state.

#### Parameters

-   `state` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** Current Collection state.
-   `initialState` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** Initial Collection state (refer to `createCollectionState`).

### createReducer

Creates an returns a custom reducer function.

#### Parameters

-   `initialState` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** Collection state.
-   `actionTypes` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** Object containing required action types.
-   `handlers` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** Object containing custom reducer action creators. (optional, default `{}`)

#### Examples

```javascript
// job.actions.js
export default {
 ADD_ENTITY: '[Job] Add Entity',
 REMOVE_ENTITY: '[Job] Remove Entity',
 CUSTOM: '[Job] Custom'
 ...
}

// job.reducer.js
import { createReducer, createCollectionState } from '@foundcareers/redux-entity';
import jobActionTypes from './job.action';

// Creating a reducer for a collection of entities (default case)
export const reducer = createReducer(
 createCollectionState(),
 jobActionTypes
);

// Creating a reducer for a collection of entities (*customized case)
export const reducer = createReducer(
 createCollectionState(),
 jobActionTypes,
 {
   [jobActionTypes.CUSTOM]: (state, payload) => ({
     ...state, custom: payload
   })
 }
);
```

## Selectors

### getEntities

Get entities from a collection state.

#### Parameters

-   `state` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** Collection state.

### getEntitiesArray

Get a sorted array of entities from a collection state.

#### Parameters

-   `state` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** Collection state.
-   `compareFunction` **[function](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/function)** Comparator used to compare two objects.

#### Examples

```javascript
import {getEntitiesArray} from '@foundcareers/redux-entity';

const todoState = {
 entities: {
   'be9a-423mfas5345sd': {
     id: 'be9a-a25d21033a20',
     value: 'Write todo'
   },
   'be9a-a245gf2033a20': {
     id: 'be9a-a245gf2033a20',
     value: 'Grill salmon'
   }
 },
 meta: {
   currentPage: 2,
   nextPage: 3,
   prevPage: 1,
   totalPages: 4,
   totalCount: 12,
 },
 selectedEntityId: 'be9a-a245gf2033a20'
};

const compareFunction = (a, b) => a.value.localeCompare(b.value);

const entities = getEntitiesArray(todoState, compareFunction);

// Resulting in the following entities array
[
 {
   id: 'be9a-a245gf2033a20',
   value: 'Grill salmon'
 },
 {
   id: 'be9a-423mfas5345sd',
   value: 'Write todo'
 }
]
```

### getSelectedEntityId

Get the selected entity id from a collection state.

#### Parameters

-   `state` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** Collection state.

### getMeta

Get meta from a collection state.

#### Parameters

-   `state` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** Collection state.

### getNextPage

Get next page from a collection meta.

#### Parameters

-   `state` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** Collection state.

### getPrevPage

Get previous page from a collection meta.

#### Parameters

-   `state` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** Collection state.

### getStartCursor

Get start cursor from a collection meta.

#### Parameters

-   `state` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** Collection state.

### getEndCursor

Get end cursor from a collection state.

#### Parameters

-   `state` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** Collection state.

## Factories

### createCollectionState

Creates an initial collection state object with standard or cursor meta.

#### Parameters

-   `state` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** Object that's spread into the collection state. (optional, default `{}`)
-   `options` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** Configuration object. (optional, default `{}`)
    -   `options.useCursor` **[boolean](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean)** Set to `true` to use cursor meta. `false` for default meta.

#### Examples

```javascript
import { createCollectionState } from '@foundcareers/redux-entity';

// State with Cursor Pagination
const stateWithMetaPagination = createCollectionState({}, {
 useCursor: true
});

// stateWithMetaPagination
{
 entities: {},
 meta: {
   endCursor: null,
   hasNextPage: null,
   startCursor: null
 },
 selectedEntityId: null,
}
```
